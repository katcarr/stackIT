<h1><%= @question.ask %></h1>

<br>
<h3>Answers</h3>
  <% @question.bestFirst.each do |response| %>
    <div class="well row">
      <div class="col-sm-9">
        <p><b>User <%= response.user.email %> says:</b></p>
        <p><%= response.answer %></p>
      </div>
      <div class="col-sm-2">
        <div id="remove-vote-<%= response.id %>">
          <%= link_to "Remove Vote", downvote_new_response_vote_path(response), class: "btn btn-danger", remote: true %>
        </div>
        <div id="upvote-<%= response.id %>">
          <%= link_to "Vote Up", upvote_new_response_vote_path(response), class: "btn btn-success", remote: true %>
        </div>
      </div>
      <div class="col-sm-1">
        <div id="vote-container-<%= response.id %>">
          <div id="response-<%= response.id %>-votes">
            <%= response.get_likes.size %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

<% if current_user %>
  <%= form_for [@question, @response], class:"form-horizontal" do |f| %>
    <%= f.label :answer, class:"form-label" %>
    <%= f.text_field :answer, class:"form-control" %>
  <br>
    <%= f.submit "AnswerIT", class: ['btn-warning', 'btn'] %>
  <% end %>
<% end %>


<script>
  <% @question.responses.each do |r| %>
    if (<%= current_user.voted_up_on? r %>) {
      $('#upvote-<%= r.id %>').hide();
    }
    else {
      $('#remove-vote-<%= r.id %>').hide();
    }
  <% end %>
</script>
